# ElementHider — 改善案

---

## 優先度：高

### 1. ページロード時のちらつき防止

**課題**
現在は JavaScript が実行されてから `display: none` を適用するため、ページ読み込み直後に非表示要素が一瞬表示される。

**解決策**
`chrome.scripting.insertCSS` を使い、JS より先に CSS を注入する。または `background.ts` から `declarativeNetRequest` でページ読み込み前にスタイルを挿入する。

---

### 2. 右クリックコンテキストメニュー対応

**概要**
ピッカーを起動しなくても、任意の要素を右クリック → 「この要素を非表示」で即時登録できる。

**実装**
`chrome.contextMenus.create` でメニュー項目を追加し、クリック時に `content.tsx` へ `HIDE_ELEMENT` メッセージを送信する。

---

### 3. 一括表示/非表示の切り替え

**概要**
ポップアップ上部に「全て非表示」「全て表示」ボタンを追加し、ワンクリックで全管理要素を一括切り替えできる。

**UI 案**
```
[ 全て表示 ]  [ 全て非表示 ]
```

**実装メモ**
- 右クリックメニューでトグルも追加
- `managedElements.every(e => e.isHidden)` で現在の状態を判断し、トグルボタンにしても良い
- 全件に対して `SHOW_ELEMENT` / `HIDE_ELEMENT` メッセージを送信し、ストレージを一括更新する

---

## 優先度：中

### 4. 拡張アイコンへのバッジ表示

**概要**
現在のタブで非表示中の要素数を拡張アイコンのバッジに表示する。

**実装**
`background.ts` でストレージの変更を検知し、`chrome.action.setBadgeText` でカウントを更新する。

---

### 5. インポート / エクスポート

**概要**
設定全体を JSON ファイルとして保存・読み込みできる。別のブラウザや端末への移行に便利。

**実装**
ポップアップの設定画面から `chrome.storage.local.get(null)` の結果を Blob としてダウンロード。読み込みは `FileReader` でパースして `chrome.storage.local.set`。

---

### 6. セレクターの直接入力

**概要**
ピッカーを使わずに CSS セレクターをテキスト入力で直接追加できる。開発者や上級者向け。

**UI 案**
リスト下部に折りたたみ式の入力フォームを配置する。

---

## 優先度：低

### 7. サイト横断ビュー

**概要**
全サイト分の管理要素を一覧できる画面。不要なサイトのデータをまとめて削除できる。

---

### 8. 要素のラベル編集

**概要**
自動生成されたラベルをユーザーが後から変更できる。要素が多い場合に管理しやすくなる。

---

### 9. キーボードショートカット

**概要**
`chrome.commands` API を使い、ピッカーの起動をキーボードで行えるようにする。

**`manifest.json` 追加例**
```json
"commands": {
  "toggle-picker": {
    "suggested_key": { "default": "Alt+Shift+H" },
    "description": "ピッカーを起動/停止"
  }
}
```